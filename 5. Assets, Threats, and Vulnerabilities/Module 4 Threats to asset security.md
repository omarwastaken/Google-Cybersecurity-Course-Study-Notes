# Social Engineering

## The Criminal Art of Persuasion

### Introduction

When you hear the word "cybercriminal," you may imagine a hacker hunched over a computer in a dark room. This is a common perception, but online criminals aren't always that different from those operating in the real world. Malicious hackers are just one type of online criminal, relying on sophisticated programming skills for their attacks. However, there are other ways to commit crimes that don't require programming skills, such as social engineering.

### Social Engineering

**Social engineering** is a manipulation technique that exploits human error to gain private information, access, or valuables. These tactics trick people into breaking normal security procedures on the attacker's behalf. This can lead to data exposures, widespread malware infections, or unauthorized access to restricted systems. Social engineering attacks can happen anywhere, whether online, in-person, or through other interactions. Threat actors use many different tactics to carry out their attacks.

### Stages of Social Engineering Attacks

1. **Preparation**: Attackers gather information about their target. Using this intel, they determine the best way to exploit them.
2. **Establishing Trust (Pretexting)**: Attackers use the information gathered to open a line of communication, disguising themselves to trick their target into a false sense of trust.
3. **Persuasion**: Attackers manipulate their target into volunteering information, often using specific vocabulary that makes them sound like a member of the organization.
4. **Disconnection**: After collecting the information they want, attackers break communication with their target and disappear to cover their tracks.

### Types of Social Engineering Attacks

- **Quick Attacks**: For example, someone impersonating tech support asks an employee for their password to fix their computer.
- **Long-term Attacks**: Threat actors monitor an employee's social media over months, exploiting opportunities when the employee appears less knowledgeable about security procedures.

### Preventing Social Engineering Attacks

- **Managerial Controls**: Implement policies, standards, and procedures as the first line of defense. For example, businesses often follow the patch management standard defined in NIST Special Publication 800-40, which creates procedures for updating operating systems, applications, and firmware that can be exploited.
- **Staying Informed**: Security professionals must stay updated on trends and share their knowledge with others. Attackers rely on our natural curiosity and desire to help one another, hoping that targets won't think too hard about what's going on.
- **Training and Awareness**: Teaching the signs of social engineering attacks to others helps in preventing these threats.

### Key Takeaways

- **Understanding Social Engineering**: Social engineering exploits human error and relies on manipulation techniques rather than programming skills.
- **Stages of Attack**: Preparation, establishing trust, persuasion, and disconnection are the key stages of a social engineering attack.
- **Prevention Measures**: Implementing managerial controls, staying informed about trends, and educating others about the signs of social engineering attacks are crucial in defending against these threats.

### Conclusion

Social engineering poses a significant threat to the assets and privacy of both individuals and organizations. Malicious attackers use various tactics to confuse and manipulate their targets. Understanding and recognizing these techniques are essential for preventing such attacks and ensuring the security of sensitive information.

## Social Engineering Tactics

### Introduction

Social engineering attacks are a popular choice among threat actors because it's often easier to trick people into providing access, information, or money than it is to exploit a software or network vulnerability. Social engineering is a manipulation technique that exploits human error to gain private information, access, or valuables. This reading covers specific social engineering tactics and ways organizations can counter these threats.

### Social Engineering Risks

Social engineering preys on people’s natural feelings of curiosity, generosity, and excitement, turning those feelings against their targets to affect their better judgment. These attacks can be incredibly harmful because they are easy to accomplish and often bypass technological defenses.

## **Example: The Twitter Hack of 2020**

- Attackers impersonated IT department staff.
- Gained access to Twitter’s network and internal tools.
- Took over high-profile accounts.

### Signs of an Attack

Social engineering attacks are difficult to prevent, but recognizing the signs can reduce their likelihood. Here are common types of social engineering to watch out for:

### Common Social Engineering Tactics

|Tactic|Description|
|---|---|
|**Baiting**|Tempts people into compromising security. Example: USB baiting.|
|**Phishing**|Uses digital communications to trick people into revealing sensitive data or deploying malicious software. Commonly performed via email.|
|**Quid pro quo**|Tricks someone into believing they’ll be rewarded for sharing access, information, or money. Example: Impersonating a loan officer.|
|**Tailgating**|Unauthorized person follows an authorized person into a restricted area. Also known as piggybacking.|
|**Watering hole**|Compromises a website frequently visited by a specific group. Example: Holy Water attack of 2020.|

### Encouraging Caution

Spreading awareness through comprehensive security training is essential. Focus on three main areas when teaching others:

1. **Stay alert**: Be suspicious of unusual communications and unknown people. Look out for spelling errors and double-check the sender’s name and email address.
2. **Be cautious**: Avoid sharing sensitive information, especially on social media.
3. **Control curiosity**: Avoid clicking on suspicious attachments or links.

**Pro Tip**: Implement technologies like firewalls, multi-factor authentication (MFA), block lists, and email filtering to add layers of defence.

### Extending Security Training

- **Employees**: Regularly train them on recognizing and responding to social engineering attacks.
- **Customers**: Educate them about potential threats and how to protect themselves.

### Role of Security Analysts

Security analysts play a crucial role in promoting safe practices by testing systems and documenting best practices for others in the organization to follow.

### Key Takeaways

- Social engineering exploits human nature and error, making it a potent tactic for criminals.
- Attacks can be hard to detect and prevent but recognizing the signs and implementing effective controls can mitigate the risks.
- Educating employees and customers on social engineering threats and promoting vigilance are essential for preventing attacks.

### Resources for More Information

- **[OUCH!](https://www.sans.org/newsletters/ouch/)** : A free monthly newsletter from the SANS Institute reporting on social engineering trends and other security topics.
- **[Scamwatch](https://www.scamwatch.gov.au/)** : A resource for news and tools to recognize, avoid, and report social engineering scams.

## Phishing for Information

### Introduction

Cybercriminals often prefer attacks that cause significant damage with minimal effort. One of the most popular forms of social engineering that fits this description is phishing. Phishing involves using digital communications to trick people into revealing sensitive data or deploying malicious software. While it leverages many communication technologies, phishing primarily refers to attacks arriving by email.

### Impact of Phishing Attacks

Phishing attacks don't just affect individuals but are also harmful to organizations. A single employee falling for a phishing trick can give attackers access to sensitive systems and data, such as customer names and product secrets.

### Phishing Kits

Attackers commonly use phishing kits to carry out these attacks. A phishing kit is a collection of software tools needed to launch a phishing campaign, making it accessible even to individuals with little technical background. The three main tools in a phishing kit are:

1. **Malicious Attachments**: Files that are infected and can harm an organization's systems.
2. **Fake Data Collection Forms**: Forms that look legitimate but ask for sensitive information not typically requested in an email.
3. **Fraudulent Web Links**: Links to malicious web pages designed to look like trusted brands to steal information, such as login credentials.

### Forms of Phishing Attacks

Phishing attacks can be launched through various forms of communication, including malicious emails, smishing, and vishing.

#### Smishing

Smishing uses text messages to obtain sensitive information or impersonate a known source. Smishing messages can be easy or difficult to detect. Some promise rewards for clicking a link, while others use local area codes or pretend to be friends or family to appear legitimate.

#### Vishing

Vishing exploits electronic voice communication to obtain sensitive information or impersonate a known source. For example, attackers might call pretending to be a company representative, claiming there's a problem with an account and offering to fix it if the victim provides sensitive information.

### Prevention Measures

Organizations use various security measures to prevent phishing attacks, such as:

- **Anti-Phishing Policies**: Spread awareness and encourage correct data security procedures.
- **Employee Training**: Inform employees about detecting suspicious emails.
- **Securing Email Inboxes**: Email filters, blocklists, and allowlists help prevent harmful messages from reaching users.
- **Intrusion Prevention Systems**: Monitor email traffic for unusual patterns, quarantine suspicious emails, and log events.

### Key Takeaways

Phishing campaigns are popular and dangerous forms of social engineering. Organizations of all sizes need to deal with them. A single compromised password can lead to a costly data breach. By understanding the tools and tactics attackers use, security professionals can better equip themselves to spot and prevent phishing attacks.

## Types of Phishing

### Introduction

Phishing is one of the most common types of social engineering, exploiting human error to gain private information, access, or valuables. It uses digital communications to trick people into revealing sensitive data or deploying malicious software. This reading explores common phishing tactics used by attackers today.

### The Origins of Phishing

Phishing dates back to the early days of the internet, emerging in the 1990s. As people came online for the first time, malicious actors took advantage of the internet's anonymity to commit crimes.

#### Early Persuasion Tactics

One of the earliest instances targeted AOL Instant Messenger (AIM). Users received emails asking them to verify accounts or provide billing information, tricking them into sharing details with attackers pretending to be service providers. This mass phishing attack involved carefully crafted emails that appeared to come from AOL, using official logos and designs to deceive users.

### Evolution of Phishing

Phishing evolved with the rise of businesses and new technologies in the digital landscape. The early 2000s saw the emergence of e-commerce and online payment systems, presenting new opportunities for attackers. Five common types of phishing emerged:

1. **Email Phishing**: Attacks sent via email where attackers pretend to be a trusted person or entity.
2. **Smishing**: Uses SMS or text messaging services to deceive targets.
3. **Vishing**: Involves voice calls or messages to trick targets into providing personal information.
4. **Spear Phishing**: Targets specific individuals, such as small business accountants.
5. **Whaling**: A type of spear phishing aimed at high-ranking executives.

Email phishing remains the most common type, often used to infect systems with malicious software. In late 2003, attackers created fraudulent websites resembling businesses like eBay and PayPal™, launching mass phishing campaigns against e-commerce and banking sites.

### Recent Trends

In the 2010s, attackers shifted from mass phishing to targeted phishing, using highly customized methods to create a sense of familiarity with specific targets. A notable technique from this period is angler phishing, where attackers impersonate customer service representatives on social media. They intercept complaints and contact customers with fraudulent accounts, tricking them into sharing sensitive information under the guise of resolving their issues.

### Key Takeaways

Phishing tactics have become sophisticated over the years. There isn't a perfect solution to prevent these attacks entirely, but spreading awareness and educating others can mitigate damage. Security professionals play a crucial role in helping others identify phishing and social engineering attempts by creating training programs and sharing knowledge.


---
# Malware

## Malicious Software

Malware, short for malicious software, is designed to harm devices or networks. It can be spread through infected USB drives or online between computers. Devices connected to the internet are especially vulnerable. Malware interferes with normal operations and allows attackers to take control without the user's knowledge or permission. Malware has been a threat for a long time, and many different strains have been created, each varying in how they spread.

### Common Types of Malware

### Virus

A virus is malicious code written to interfere with computer operations and cause damage to data and software. Viruses typically hide inside trusted applications. When the infected program is launched, the virus clones itself and spreads to other files on the device. An important characteristic of viruses is that they have to be activated by the user to start the infection.

### Worm

A worm is malware that can duplicate and spread itself across systems on its own. While viruses require users to perform an action like opening a file to duplicate, worms use an infected device as a host. They scan the connected network for other devices. Worms then infect everything on the network without requiring an action to trigger the spread.

### Trojan Horse

A trojan, or Trojan horse, is malware that looks like a legitimate file or program. The name is a reference to an ancient Greek legend where soldiers hid inside a giant wooden horse presented as a gift to their enemies. Like this tale, attackers design trojans to appear harmless. This type of malware is typically disguised as files or useful applications to trick their target into installing them.

### Ransomware

Ransomware is a type of malicious attack where attackers encrypt an organization's data and demand payment to restore access. These attacks have become very common. A unique feature of ransomware attacks is that they make themselves known to their targets to collect the demanded payment. Normally, the data is decrypted once the sum of money is paid, but there is no guarantee they won't return to demand more.

### Spyware

Spyware is malware used to gather and sell information without consent. While organizations collect customer information with the ability to opt-out, cybercriminals use spyware to steal data like login credentials, account PINs, and other sensitive information for their gain.

### Key Characteristics of Malware

- **Virus**: Requires user action to start infection, hides in trusted applications.
- **Worm**: Self-replicates, spreads without user action, uses infected device as a host.
- **Trojan Horse**: Disguised as legitimate files/programs, used to gain access.
- **Ransomware**: Encrypts data, demands payment for decryption, makes presence known.
- **Spyware**: Steals information without consent, collects sensitive data.

### Prevention and Detection

There are many other types of malware besides these, and new forms are constantly evolving. They all pose a serious risk to individuals and organizations. Security teams use various methods to detect and remove these threats, which we will explore next time.

### Summary

Understanding different types of malware is crucial for effective cybersecurity. Each type has unique characteristics and methods of infection. Awareness and preventive measures can help mitigate the risks posed by these malicious programs.


## An Introduction to Malware

Previously, you learned that malware is software designed to harm devices or networks. Since its first appearance on personal computers decades ago, malware has developed into a variety of strains. Being able to identify different types of malware and understand the ways in which they are spread will help you stay alert and be informed as a security professional.

### Virus

A virus is malicious code written to interfere with computer operations and cause damage to data and software. This type of malware must be installed by the target user before it can spread itself and cause damage. One of the many ways that viruses are spread is through phishing campaigns where malicious links are hidden within links or attachments.

### Worm

A worm is malware that can duplicate and spread itself across systems on its own. Similar to a virus, a worm must be installed by the target user and can also be spread with tactics like malicious email. Given a worm's ability to spread on its own, attackers sometimes target devices, drives, or files that have shared access over a network.

#### Example: Blaster Worm

- Also known as Lovesan, Lovsan, or MSBlast
- Spread on computers running Windows XP and Windows 2000
- Forced devices into a continuous loop of shutting down and restarting
- Did not damage devices but spread to hundreds of thousands of users

### Trojan

A trojan, also called a Trojan horse, is malware that looks like a legitimate file or program. Similar to viruses, attackers deliver this type of malware hidden in file and application downloads. Trojans trick users into believing they’re downloading a harmless file, while actually infecting their device with malware that can be used to spy on them, grant access to other devices, and more.

### Adware

Adware, or advertising-supported software, is a type of legitimate software used to display digital advertisements in applications. Software developers use adware to lower production costs or make their products free to the public (freeware/shareware). Malicious adware falls into a sub-category of malware known as a potentially unwanted application (PUA), which might display ads, cause device slowdown, or install other software.

### Spyware

Spyware is malware that's used to gather and sell information without consent. It is commonly hidden in bundleware, additional software that is sometimes packaged with other applications. Spyware is considered a PUA and is a serious challenge in the open-source software development ecosystem.

### Scareware

Scareware is a type of PUA that employs tactics to frighten users into infecting their own device. It tricks users by displaying fake warnings that appear to come from legitimate companies. Email and pop-ups are common ways scareware is spread.

### Fileless Malware

Fileless malware does not need to be installed by the user because it uses legitimate programs that are already installed to infect a computer. This type of infection resides in memory where the malware never touches the hard drive. Fileless malware is detected by performing memory analysis.

### Rootkits

A rootkit is malware that provides remote, administrative access to a computer. Attackers use rootkits to open a backdoor to systems, allowing them to install other forms of malware or conduct network security attacks. Rootkits are often spread by a combination of two components: a dropper and a loader.

#### Dropper

A type of malware that comes packed with malicious code, delivered and installed onto a target system. Often disguised as a legitimate file to deceive the target.

#### Loader

A type of malware that downloads strains of malicious code from an external source and installs them onto a target system. Used to set up another type of malware, such as a botnet.

### Botnet

A botnet, short for "robot network," is a collection of computers infected by malware under the control of a single threat actor, known as the "bot-herder." Viruses, worms, and trojans are often used to spread the initial infection and turn the devices into bots. The bot-herder can execute commands on the infected computers.

### Ransomware

Ransomware describes a malicious attack where threat actors encrypt an organization's data and demand payment to restore access. Ransomware crimes are on the rise and becoming increasingly sophisticated. An example is the WannaCry attack that encrypts a victim's computer until a ransom payment of cryptocurrency is paid.

## Key Takeaways

The variety of malware is astounding, and the number of ways it’s spread is even more staggering. Malware is a complex threat that can require its own specialization in cybersecurity. Recognizing the types of malware and how they’re spread is an important part of defending against these attacks as a security analyst.


## The Rise of Cryptojacking

### Introduction

Malware has existed almost as long as computers themselves. Initially, it was used for digital vandalism, but today, it has evolved into a profitable crime for financial gain. As a security professional, staying updated on the latest malware trends is crucial. One such evolution is cryptojacking.

### What is Cryptojacking?

Cryptojacking is a type of malware that installs software to mine cryptocurrencies illegally. Cryptocurrencies, like Bitcoin and Ethereum, are digital currencies with real-world value. They are referred to as coins or tokens.

#### Understanding Cryptocurrency and Mining

Cryptocurrency mining involves using computers to solve complex mathematical problems to earn coins. This process is akin to mining for physical resources like gold, which involves machinery like trucks and bulldozers. Similarly, crypto mining uses computers to process large amounts of encrypted data to find new coins.

### The Emergence of Cryptojacking

#### Timeline

- **2017:** Cryptojacking malware began to be used to gain unauthorized control of personal computers for mining cryptocurrency.
- **Post-2017:** Cryptojacking techniques have become more sophisticated, targeting vulnerable servers to spread mining software. These infected servers then spread the malware to other connected devices, running the mining software in the background.

### Detecting Cryptojacking

Cryptojacking software is hard to detect, but there are tools and signs that can help identify it.

#### Intrusion Detection Systems (IDS)

An IDS monitors system activity and alerts security personnel to possible intrusions. When abnormal activities like unauthorized crypto mining are detected, the IDS sends alerts.

#### Signs of Cryptojacking Infection

- **Slowdown:** The most telling sign of a cryptojacking infection is a noticeable slowdown in system performance.
- **Increased CPU Usage:** Unexpected spikes in CPU usage can indicate mining activities.
- **System Crashes:** Frequent and sudden system crashes can be a sign of malware.
- **Fast Draining Batteries:** Cryptojacking software can drain batteries quickly due to high resource usage.
- **High Electricity Costs:** The resource-intensive process of crypto mining leads to unusually high electricity costs.

### Preventing Cryptojacking

To reduce the likelihood of cryptojacking attacks, several preventive measures can be implemented.

#### Defensive Measures

- **Browser Extensions:** Use extensions designed to block malware.
- **Ad Blockers:** Ad blockers can help prevent malicious ads from delivering cryptojacking scripts.
- **Disable JavaScript:** Disabling JavaScript can prevent some types of cryptojacking scripts from running.
- **Stay Informed:** Keeping up with the latest trends in malware can help anticipate and defend against new attacks.

### Educating Others

Security analysts can play a significant role in educating others within their organizations about the dangers of malware attacks, including cryptojacking.

### Conclusion

Cryptojacking is a relatively new but growing threat. With malware continuously evolving, it takes experience to analyse and defend against new forms. Nevertheless, understanding cryptojacking and implementing preventive measures are essential steps toward protecting against these threats.


---
# Web-based exploits

## Cross-Site Scripting (XSS)

### Introduction to Malware Delivery

Malware, which can infect individual computers or network servers, needs a delivery method to be effective. While phishing and social engineering techniques are common delivery methods, web-based exploits also pose significant threats. These exploits take advantage of coding flaws in web applications to gain access to sensitive information.

### Web-Based Exploits

**Definition:** Web-based exploits are malicious codes or behaviors targeting coding flaws in web applications.

**Why They Occur:** Web applications interact with multiple users across various networks, making them susceptible to these exploits. Injection attacks are a common type of web-based exploit.

**Injection Attacks:** This involves inserting malicious code into a vulnerable application. The infected application may appear to function normally while the injected code operates in the background.

### Cross-Site Scripting (XSS)

**Definition:** XSS is an injection attack that inserts malicious code into a vulnerable website or web application, primarily exploiting HTML and JavaScript.

**Impact:** XSS can provide attackers access to session cookies, geolocation, webcams, and microphones.

### Types of Cross-Site Scripting Attacks

#### 1. Reflected XSS

**Mechanism:** The malicious script is sent to the server and activated during the server's response.

**Example:** A common example is a search bar on a website. Attackers send a link to the target that appears legitimate. When the link is clicked, it sends an HTTP request to the server, and the server reflects the malicious script back to the user's browser, which then loads the script, sending session cookies back to the attacker.

**Process:**

1. Attacker sends a malicious link.
2. Target clicks the link, sending a request to the server.
3. Server reflects the malicious script back to the browser.
4. Browser executes the script, sending sensitive data to the attacker.

#### 2. Stored XSS

**Mechanism:** The malicious script is injected directly into the server.

**Example:** Attackers target elements like images and buttons that load when a site is visited. When the user visits the site, these infected elements activate the malicious code.

**Process:**

1. Attacker injects a script into the server.
2. User visits the site with the infected elements.
3. Malicious code executes without the user knowing.

#### 3. DOM-Based XSS

**Mechanism:** The malicious script exists in the web page's Document Object Model (DOM).

**Example:** The malicious script can be seen in the URL. For instance, if a website’s URL contains parameter values, attackers can hide malicious JavaScript in the HTML tags. The browser processes the HTML and executes the JavaScript.

**Process:**

1. Attacker modifies the URL parameter values.
2. User visits the modified URL.
3. Browser processes the URL, executes the malicious script.

### Key Takeaways

- **XSS Attacks:** These can be highly damaging because they exploit user trust in a web application or website.
- **Types of XSS:** Reflected, Stored, and DOM-based attacks each have unique mechanisms and impacts.
- **Security Measures:** Awareness and knowledge of XSS are crucial for security analysts to protect against such vulnerabilities.

## Exploitable Gaps in Databases

### Introduction to Web-Based Exploits

Web-based exploits take advantage of coding flaws in web applications to access sensitive data. One common type of web-based exploit is SQL injection, which targets how websites interact with databases.

### SQL and Web Applications

## **SQL Overview:**

- SQL (Structured Query Language) is used to create, interact with, and request information from a database.
- Widely used by web applications, especially e-commerce sites.

## **Example:**

- An online clothing store's database might contain its entire inventory.
- Users interact with the database through menus, images, and buttons rather than direct SQL queries.
- Actions like adding an item to a shopping cart trigger SQL queries in the background.

### SQL Injection

## **Definition:**

- SQL injection is an attack that executes unexpected queries on a database.
- Occurs due to a lack of sanitized input, where user inputs are directly used in SQL statements.

## **How It Happens:**

- Web forms (e.g., login forms) copy user input into SQL statements exactly as written.
- If user input is not sanitized, attackers can insert additional SQL code to manipulate the database.

## **Example:**

- A login form might use a SQL statement to verify user credentials.
- An attacker could input additional SQL code to modify the query, potentially accessing sensitive data or gaining administrative rights.

### Defending Against SQL Injection

## **Sanitizing Input:**

- Critical to ensure that user inputs are safe and do not contain malicious SQL code.
- Developers should write code to detect and handle specific SQL characters.

## **Prepared Statements:**

- A coding technique that executes SQL statements before passing them to the database.
- Validates user input before performing the query, preventing malicious code from being executed.

## **Best Practices:**

- Use prepared statements for any user input that will be part of a SQL query.
- Regularly test applications for SQL injection vulnerabilities.

### Example of a SQL Injection Vulnerability

```sql
-- Example of vulnerable SQL statement in a login form 
SELECT * FROM users WHERE username = 'user_input' AND password = 'password_input';  
-- Example of an attack input 
user_input = 'admin' OR '1' = '1'; -- This can modify the query to return all users  
-- Vulnerable query after injection 
SELECT * FROM users WHERE username = 'admin' OR '1' = '1' AND password = 'password_input';
```

### Using Prepared Statements

**Example of a Prepared Statement:**

```sql
-- Using a prepared statement to prevent SQL injection 
SELECT * FROM users WHERE username = ? AND password = ?;  
-- User inputs are validated before being passed to the database 
prepared_statement.setString(1, user_input); 
prepared_statement.setString(2, password_input); 
prepared_statement.executeQuery();
```

### Collaboration Between Security Teams and Developers

- Security teams and developers must work together to test and secure applications.
- Regular code reviews and security testing can identify and fix vulnerabilities.
- Injection attacks are just one type of web-based exploit that security teams must defend against.

### Key Takeaways

- SQL injection exploits flaws in how web applications handle user inputs.
- Sanitizing inputs and using prepared statements are effective defences.
- Collaboration between security teams and developers is essential for securing applications.
- Regular testing and code reviews help identify and mitigate vulnerabilities.

## Prevent Injection Attacks

### Introduction to SQL and Injection Attacks

Structured Query Language (SQL) is widely used to create, interact with, and request information from databases. Due to its popularity, SQL injection (SQLi) attacks are common, allowing threat actors to modify, delete, or steal information from databases. These attacks exploit input fields in web applications that accept SQL queries but lack proper input sanitization.

### SQL Queries

## **What is a SQL Query?**

- SQL queries are requests for data from a database.
- Databases store information in organized tables.
- SQL is used for retrieving, inserting, updating, or deleting information in these tables.

## **Example:**

- An employee directory database may store employee IDs, names, and job titles.
- A SQL query can filter and retrieve specific employee information from the database.

## **Vulnerable Input Fields:**

- Input fields like login forms, search bars, and comment boxes accept text input.
- SQL injections occur when these fields do not filter out unwanted text, allowing attackers to manipulate the database.

### SQL Injection Categories

#### In-Band SQL Injection

- **Definition:** Uses the same communication channel to launch the attack and gather results.
- **Example:** An attacker uses a search box on a retailer's website to input a malicious query. The query is executed, and sensitive information like passwords is returned in the search box.

#### Out-of-Band SQL Injection

- **Definition:** Uses a different communication channel to launch the attack and gather results.
- **Example:** An attacker creates a connection between a vulnerable website and their own database, bypassing security controls to steal sensitive data.
- **Note:** This type of attack is uncommon and depends on specific server features being enabled.

#### Inferential SQL Injection

- **Definition:** The attacker cannot see the results directly but infers them by analyzing the system's behavior.
- **Example:** An attacker inputs a malicious query in a login form causing an error message. By analyzing the error, they learn about the database's structure and craft further attacks.

### Injection Prevention

## **Why Prevention is Necessary:**

- SQL queries often assume user input will be formatted correctly.
- Attackers exploit this assumption to insert malicious code.

**Techniques to Prevent SQL Injection:**

1. **Prepared Statements:**
    
    - Execute SQL statements before passing them to the database.
        
    - Example:
        
        `-- Using a prepared statement to prevent SQL injection SELECT * FROM users WHERE username = ? AND password = ?;  -- User inputs are validated before being passed to the database prepared_statement.setString(1, user_input); prepared_statement.setString(2, password_input); prepared_statement.executeQuery();`
        
2. **Input Sanitization:**
    
    - Remove user inputs that could be interpreted as code.
    - Example: Removing SQL special characters from the input.
3. **Input Validation:**
    
    - Ensure user input meets system expectations.
    - Example: Validating that an email input is properly formatted.

## **Collaborating with Developers:**

- Security professionals must work closely with application developers.
- Share knowledge on SQL injection techniques and preventative measures.
- Regular code reviews and security testing help identify and fix vulnerabilities.

### Key Takeaways

- SQL is commonly used in web applications to interact with databases.
- SQL injections are common due to the popularity of the language and insufficient input sanitization.
- Understanding SQL queries and injection techniques is crucial for preventing attacks.
- Collaboration between security teams and developers is essential for securing applications against SQL injection attacks.

---
# Treat modeling

## A Proactive Approach to Security

### Introduction
Preparing for attacks is a crucial responsibility for the entire security team. Threat actors have various tools they use depending on their target. For instance, attacking a small business differs from attacking a public utility. Each target has different assets and specific defenses to keep them safe. Anticipating attacks is key to preparation, achieved through an activity known as threat modeling.

### Threat Modeling
Threat modeling is the process of identifying assets, their vulnerabilities, and how they are exposed to threats. This process applies to everything we protect, including entire systems, applications, and business processes, examined from a security-related perspective.

#### Steps of Threat Modelling
There are six general steps in threat modelling:

1. **Define the Scope**
   - Determine what to protect by creating an inventory of assets and classifying them.

2. **Identify Threats**
   - Define all potential threat actors, characterized as internal or external. Examples include:
     - Internal: Employees intentionally exposing an asset to harm.
     - External: Malicious hackers or competing businesses.

3. **Characterize the Environment**
   - Apply an attacker mindset to the business, considering how customers, employees, external partners, and third-party vendors interact with the environment.

4. **Analyse Threats**
   - Examine existing protections, identify gaps, and rank threats according to their risk score.

5. **Mitigate Risk**
   - Create a plan to defend against threats, with options to avoid, transfer, reduce, or accept risk.

6. **Evaluate Findings**
   - Document the process, apply fixes, and record successes and lessons learned to inform future threat models.

### Threat Modeling Frameworks
Several threat modeling frameworks are used in the field, tailored for different security needs such as network security, information security, or application development. 

### Conclusion
Threat modeling is a lengthy and detailed activity typically performed by experienced individuals. While it's considered an advanced skill, involvement in the process provides valuable learning opportunities. The steps and frameworks ensure comprehensive analysis and preparation against potential threats, enhancing the security posture of the organization.

## PASTA: The Process for Attack Simulation and Threat Analysis

### Introduction

PASTA (Process for Attack Simulation and Threat Analysis) is a comprehensive threat modeling framework used across various industries. It helps security teams identify, analyse, and address potential threats to applications and systems. This framework is especially useful in real-world scenarios, such as ensuring the security of a mobile app before its launch.

### Stage 1: Define Business and Security Objectives

- **Goal**: Establish the main objectives of the threat modeling process.
- **Example**: For a fitness company launching a mobile app, the primary objective is to protect customer data.
- **Activities**:
    - Ask questions about how personally identifiable information (PII) is handled.
    - Understand the impact of potential threats on customer data.

### Stage 2: Define the Technical Scope

- **Goal**: Identify the components of the application that need to be evaluated.
- **Activities**:
    - Determine the attack surface, including technology involved while data is at rest and in use.
    - Identify network protocols, security controls, and other data interactions relevant to the app.

### Stage 3: Decompose the Application

- **Goal**: Identify existing controls that protect user data from threats.
- **Activities**:
    - Collaborate with application developers to create a data flow diagram.
    - Diagram should show how data moves from a user's device to the company’s database.
    - Identify controls in place to protect data throughout this process.

### Stage 4: Perform a Threat Analysis

- **Goal**: Research and identify potential threats using the latest information on attack vectors.
- **Activities**:
    - Adopt an attacker mindset.
    - Use up-to-date resources to identify current threats targeting mobile apps.

### Stage 5: Perform a Vulnerability Analysis

- **Goal**: Investigate potential vulnerabilities in detail.
- **Activities**:
    - Consider the root causes of vulnerabilities identified in the previous stage.

### Stage 6: Conduct Attack Modelling

- **Goal**: Simulate attacks to test identified vulnerabilities.
- **Activities**:
    - Create an attack tree that maps out potential attack vectors and methods.
    - Example:
        - **Target**: Customer information (e.g., usernames and passwords).
        - **Storage**: Data stored in a database.
        - **Attack Vector**: SQL injection due to unsanitized inputs.
        - **Attack Tree Branch**: Identify and test this vector among others in the app.

### Stage 7: Analyse Risk and Impact

- **Goal**: Assemble collected information and make risk management recommendations.
- **Activities**:
    - Compile findings from stages 1 through 6.
    - Provide informed recommendations to business stakeholders that align with their goals.

### Conclusion

The PASTA framework is a structured approach to threat modeling that ensures comprehensive analysis and preparation against potential threats. By following its seven stages, security teams can proactively protect applications and systems, such as a fitness company’s mobile app, from a wide range of cyber threats.

## Traits of an Effective Threat Model

**Threat modeling** is the process of identifying assets, their vulnerabilities, and how each is exposed to threats. It is a strategic approach that combines various security activities, such as vulnerability management, threat analysis, and incident response. Security teams commonly perform these exercises to ensure their systems are adequately protected. Another use of threat modeling is to proactively find ways of reducing risks to any system or business process.

### Why Application Security Matters

Applications have become an essential part of many organizations' success. For example, web-based applications allow customers from anywhere in the world to connect with businesses, their partners, and other customers.

Mobile applications have also changed the way people access the digital world. Smartphones are often the main way that data is exchanged between users and a business. The volume of data being processed by applications makes securing them a key to reducing risk for everyone who’s connected.

For example, say an application uses Java-based logging libraries with the Log4Shell vulnerability ([CVE-2021-44228](https://nvd.nist.gov/vuln/detail/CVE-2021-44228)). If it's not patched, this vulnerability can allow remote code execution that an attacker can use to gain full access to your system from anywhere in the world. If exploited, a critical vulnerability like this can impact millions of devices.

### Defending the Application Layer

Defending the application layer requires proper testing to uncover weaknesses that can lead to risk. Threat modeling is one of the primary ways to ensure that an application meets security requirements. A DevSecOps team, which stands for development, security, and operations, usually performs these analyses.

## A typical threat modeling process is performed in a cycle:

- Define the scope
- Identify threats
- Characterize the environment
- analyse threats
- Mitigate risks
- Evaluate findings

![The six steps of a threat modeling exercise shown as a cycle.](https://d3c33hcgiwev3.cloudfront.net/imageAssetProxy.v1/jcxiyXGsSgiFzXVKEA2MlA_e5fb4921773047658ae29b53532617f1_IkNCZRnA8vFZL9bPa3yahdiNcz5YvwZzxcn1GyvaYWkF00CzvIWq3MkCyR_IgzOSs5bKO7iIiROjznDNMHk60Cun_ZP-OriA0rGw7gQqWHj-jiTAFPzddosn0AJ9zQxySZuHVXi856Oqf1ZWNZBt34U?expiry=1716336000000&hmac=ieMGW7AuRUYcYGZ9mCPUIUny3okV5CR5YKn6xre9z7I)

Ideally, threat modeling should be performed before, during, and after an application is developed. However, conducting a thorough software analysis takes time and resources. Everything from the application's architecture to its business purposes should be evaluated. As a result, a number of threat-modeling frameworks have been developed over the years to make the process smoother.

**Note:** Threat modeling should be incorporated at every stage of the software development lifecycle, or SDLC.

### Common Frameworks

## When performing threat modeling, there are multiple methods that can be used, such as:

- STRIDE
- PASTA
- Trike
- VAST

Organizations might use any one of these to gather intelligence and make decisions to improve their security posture. Ultimately, the “right” model depends on the situation and the types of risks an application might face.

#### **STRIDE**

STRIDE is a threat-modeling framework developed by Microsoft. It’s commonly used to identify vulnerabilities in six specific attack vectors. The acronym represents each of these vectors: spoofing, tampering, repudiation, information disclosure, denial of service, and elevation of privilege.

#### **PASTA**

The **Process of Attack Simulation and Threat Analysis** (PASTA) is a risk-centric threat modeling process developed by two OWASP leaders and supported by a cybersecurity firm called VerSprite. Its main focus is to discover evidence of viable threats and represent this information as a model. PASTA's evidence-based design can be applied when threat modeling an application or the environment that supports that application. Its seven stage process consists of various activities that incorporate relevant security artifacts of the environment, like vulnerability assessment reports.

#### **Trike**

Trike is an open source methodology and tool that takes a security-centric approach to threat modeling. It's commonly used to focus on security permissions, application use cases, privilege models, and other elements that support a secure environment.

#### **VAST**

The Visual, Agile, and Simple Threat (VAST) Modeling framework is part of an automated threat-modeling platform called ThreatModeler®. Many security teams opt to use VAST as a way of automating and streamlining their threat modeling assessments.

### Participating in Threat Modeling

Threat modeling is often performed by experienced security professionals, but it’s almost never done alone. This is especially true when it comes to securing applications. Programs are complex systems responsible for handling a lot of data and processing a variety of commands from users and other systems.

## One of the keys to threat modeling is asking the right questions:

- What are we working on?
- What kinds of things can go wrong?
- What are we doing about it?
- Have we addressed everything?
- Did we do a good job?

It takes time and practice to learn how to work with things like data flow diagrams and attack trees. However, anyone can learn to be an effective threat modeler. Regardless of your level of experience, participating in one of these exercises always starts with simply asking the right questions.

### Key Takeaways

Many people rely on software applications in their day-to-day lives. Securing the applications that people use has never been more important. Threat modeling is one of the main ways to determine whether security controls are in place to protect data privacy. Building the skills required to lead a threat modeling activity is a matter of practice. However, even a security analyst with little experience can be a valuable contributor to the process. It all starts with applying an attacker mindset and thinking critically about how data is handled.

---
## Glossary terms from module 4

**Angler phishing:** A technique where attackers impersonate customer service representatives on social media 

**Advanced persistent threat (APT):** Instances when a threat actor maintains unauthorized access to a system for an extended period of time 

**Adware:** A type of legitimate software that is sometimes used to display digital advertisements in applications

**Attack tree:** A diagram that maps threats to assets

**Baiting:** A social engineering tactic that tempts people into compromising their security

**Botnet:** A collection of computers infected by malware that are under the control of a single threat actor, known as the “bot-herder"

**Cross-site scripting (XSS):** An injection attack that inserts code into a vulnerable website or web application

**Cryptojacking:** A form of malware that installs software to illegally mine cryptocurrencies 

**DOM-based XSS attack:** An instance when malicious script exists in the webpage a browser loads

**Dropper:** A type of malware that comes packed with malicious code which is delivered and installed onto a target system

**Fileless malware:** Malware that does not need to be installed by the user because it uses legitimate programs that are already installed to infect a computer

**Hacker:** Any person or group who uses computers to gain unauthorized access to data

**Identity and access management (IAM):** A collection of processes and technologies that helps organizations manage digital identities in their environment 

**Injection attack:** Malicious code inserted into a vulnerable application

**Input validation:** Programming that validates inputs from users and other programs

**Intrusion detection system (IDS):** An application that monitors system activity and alerts on possible intrusions

**Loader:** A type of malware that downloads strains of malicious code from an external source and installs them onto a target system

**Malware:** Software designed to harm devices or networks

**Process of Attack Simulation and Threat Analysis (PASTA):** A popular threat modelling framework that’s used across many industries

**Phishing:** The use of digital communications to trick people into revealing sensitive data or deploying malicious software

**Phishing kit:** A collection of software tools needed to launch a phishing campaign

**Prepared statement:** A coding technique that executes SQL statements before passing them onto the database 

**Potentially unwanted application (PUA):** A type of unwanted software that is bundled in with legitimate programs which might display ads, cause device slowdown, or install other software

**Quid pro quo:** A type of baiting used to trick someone into believing that they’ll be rewarded in return for sharing access, information, or money

**Ransomware:** Type of malicious attack where attackers encrypt an organization’s data and demand payment to restore access

**Reflected XSS attack:** An instance when malicious script is sent to a server and activated during the server’s response 

**Rootkit:** Malware that provides remote, administrative access to a computer

**Scareware:** Malware that employs tactics to frighten users into infecting their device

**Smishing**: The use of text messages to trick users to obtain sensitive information or to impersonate a known source

**Social engineering:** A manipulation technique that exploits human error to gain private information, access, or valuables

**Spear phishing:** A malicious email attack targeting a specific user or group of users, appearing to originate from a trusted source

**Spyware:** Malware that’s used to gather and sell information without consent

**SQL (Structured Query Language):** A programming language used to create, interact with, and request information from a database

**SQL injection:** An attack that executes unexpected queries on a database

**Stored XSS attack:** An instance when malicious script is injected directly on the server

**Tailgating:** A social engineering tactic in which unauthorized people follow an authorized person into a restricted area

**Threat:** Any circumstance or event that can negatively impact assets

**Threat actor:** Any person or group who presents a security risk

**Threat modelling:** The process of identifying assets, their vulnerabilities, and how each is exposed to threats

**Trojan horse:** Malware that looks like a legitimate file or program

**Vishing:** The exploitation of electronic voice communication to obtain sensitive information or to impersonate a known source

**Watering hole attack**: A type of attack when a threat actor compromises a website frequently visited by a specific group of users

**Whaling:** A category of spear phishing attempts that are aimed at high-ranking executives in an organization

**Web-based exploits:** Malicious code or behaviour that’s used to take advantage of coding flaws in a web application